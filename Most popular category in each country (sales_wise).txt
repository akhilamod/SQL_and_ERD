
## Combining all three tables
with combined_table as (
    select * 
    from Orders o
    join Customer c
        on o.customer_id = c.customer_id
    join Items i
        on o.item_id = i.item_id
    )

## Most popular category for each country
select 
country, 
category, 
item_id, 
max(sale_country_wise) over(partition by country) 
from (
        	select 
            country, 
            item_id, 
            sum(quantity) over(
                             partition by item_id, country
                         ) as sale_country_wise,
        from combined_table
    );
